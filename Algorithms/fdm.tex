%!TEX root = ../paper.tex
\begin{algorithm}
\caption{Compute Shader for Interactive Wave Height Calculation}
\label{alg:fdm_compute}
\begin{algorithmic}[1]
\Require List of zone-specific parameters: $a$, $b$, $d(t)$, $\mathbf{p}(t-dt)$, $\mathbf{p}(t)$ and $\mathbf{p}(t-dt)$.
\For{each vertices of the FDM grid $i,j$ and zone $Z$ in the simulation domain}
    \State $k = i - \left\lfloor\frac{\mathbf{p}_x(t+dt)-\mathbf{p}_x(t)}{\delta}\right\rfloor$
    \State $l = j - \left\lfloor\frac{\mathbf{p}_z(t+dt)-\mathbf{p}_z(t)}{\delta}\right\rfloor $
    \State $o = i - \left\lfloor\frac{\mathbf{p}_x(t+dt)-\mathbf{p}_x(t-dt)}{\delta}\right\rfloor$
    \State $p = j - \left\lfloor\frac{\mathbf{p}_z(t+dt)-\mathbf{p}_z(t-dt)}{\delta}\right\rfloor$
    \State $h_{i,j}^{n+1} = d \cdot \big(a \cdot (h_{k-1,l} + h_{k+1,l} + h_{k,l-1} + h_{k,l+1})+ b \cdot h_{k,l} - h_{o,p}^{l-1} \big)$
\EndFor
\end{algorithmic}
\end{algorithm}
